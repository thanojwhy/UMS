package com.pu.dao;

import com.pu.entities.Faculty;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.RowMapper;
import org.springframework.stereotype.Repository;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.List;

@Repository
public class FacultyDAO {

    private JdbcTemplate jdbcTemplate;
    
    @Autowired
    public void setJdbcTemplate(JdbcTemplate jdbcTemplate) {
        this.jdbcTemplate = jdbcTemplate;
    }

    public int insertFaculty(Faculty d) {
        String sql="insert into faculty(FacultyId,FacultyName,DeptId) values('"+d.getFacultyId()+"', '"+d.getFacultyName()+"','"+d.getDeptId()+"')";
        return jdbcTemplate.update(sql);
    }

    public int updateFaculty(Faculty d) {
        String sql = "UPdATE faculty SET FacultyName = '" + d.getFacultyName() +"' WHERE FacultyId = " + d.getFacultyId();
        System.out.println(sql);
        return jdbcTemplate.update(sql);
    }

    public int deleteFaculty(int id) {
        String sql = "dELETE FROM faculty WHERE FacultyId="+id;
        return jdbcTemplate.update(sql);
    }
    
    @SuppressWarnings("deprecation")
	public Faculty getFacultyById(int id) {
        String sql = "SELECT * FROM faculty WHERE Faculty_id=?";
        return jdbcTemplate.queryForObject(sql, new Object[]{id}, new BeanPropertyRowMapper<>(Faculty.class));
    }

    public List<Faculty> getAllFaculty() {
        String sql = "SELECT * FROM faculty";
        return jdbcTemplate.query(sql, new RowMapper<Faculty>() {
            public Faculty mapRow(ResultSet rs, int row) throws SQLException {
                Faculty d = new Faculty();
                d.setFacultyId(rs.getInt("FacultyId"));
                d.setFacultyName(rs.getString("FacultyName"));
                d.setDeptId(rs.getInt("DeptId"));
                System.out.println(d);
                return d; 
            }
        });
    }
}

